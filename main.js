(() => {
    "use strict"; var e = {
        907: (e, t) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.jwtConstants = t.CONFIG_OPTIONS = void 0, t.CONFIG_OPTIONS = "CONFIG_OPTIONS", t.jwtConstants = { secret: "7e9bc5dc15dcbd2e8adcc6c9a58f797ab42111c4c29e0fd31da58906ca1a6246be7c8512e7451cf2840f264ecd1289f37222f67ef351cb5c8adbe9d37375658f" } }, 221: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }); let o = r(428); t.default = (0, o.registerAs)("database", () => ({ host: process.env.MONGODB_HOST, port: process.env.MONGODB_PORT })) }, 131: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }); let o = r(428); t.default = (0, o.registerAs)("database", () => ({ host: process.env.HOST, port: process.env.PORT || 5432 })) }, 257: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AllExceptionsFilter = void 0; let s = r(563), a = r(781), i = class extends a.BaseExceptionFilter { catch(e, t) { super.catch(e, t) } }; t.AllExceptionsFilter = i, t.AllExceptionsFilter = o([(0, s.Catch)()], i) }, 315: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AppController = void 0; let a = r(563), i = r(616), n = class { appService; constructor(e) { this.appService = e } getHello() { return this.appService.getHello() } }; t.AppController = n, o([(0, a.Get)(), s("design:type", Function), s("design:paramtypes", []), s("design:returntype", String)], n.prototype, "getHello", null), t.AppController = o([(0, a.Controller)(), s("design:paramtypes", [i.AppService])], n) }, 511: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__importDefault || function (e) { return e && e.__esModule ? e : { default: e } }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AppModule = void 0; let a = r(563), i = r(428), n = s(r(131)), c = s(r(221)), l = r(616), d = r(315), u = r(998), f = class { }; t.AppModule = f, t.AppModule = o([(0, a.Module)({ imports: [i.ConfigModule.forRoot({ envFilePath: "./development.env", load: [n.default, c.default], isGlobal: !0, cache: !0 }), u.injectDBModules], providers: [l.AppService], exports: [], controllers: [d.AppController] })], f) }, 616: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AppService = void 0; let a = r(563), i = r(428), n = class { configService; helloMessage; constructor(e) { this.configService = e, this.helloMessage = "Hello there, world"; let t = this.configService.get("PORT", { infer: !0 }), r = this.configService.get("MONGODB_PORT", { infer: !0 }), o = this.configService.get("URL", { infer: !0 }), s = this.configService.get("MONGODB_HOST", { infer: !0 }); console.log(`${t}-${r}-${o}-${s}`) } getHello() { return this.helloMessage } }; t.AppService = n, t.AppService = o([(0, a.Injectable)(), s("design:paramtypes", [i.ConfigService])], n) }, 756: (e, t) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.AIAdvancedStrategy = void 0, t.AIAdvancedStrategy = class { async generateSuggestion(e) { return { suggestion: "", comments: [""] } } } }, 453: function (e, t, r) {
            var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AIDefaultStrategy = void 0; let a = r(563), i = r(869); (0, r(818).config)(); let n = class {
                cohereClient; textAnalysisModelId = "command-xlarge-nightly"; defaultLanguage = "en"; constructor() { this.cohereClient = new i.CohereClientV2({ token: process.env.COHERE_API_KEY || "" }) } async generateSuggestion(e) { try { let [t, r, o] = await Promise.all([this.analyzeText(e), this.analyzeComments(e.comments), this.analyzeFlightData(e.fromWhereLocation, e.toWhereLocation)]); return { suggestion: t, comments: r, weather: "Not implemented", tourism: o } } catch (e) { throw console.error("Error in generateSuggestion:", e), Error("Bir hata oluştu ve öneriler oluşturulamadı.") } } async sendCohereRequest(e) { try { let t = await this.cohereClient.chat({ model: this.textAnalysisModelId, messages: [{ role: "user", content: e }] }); return t.message.content?.[0]?.text || "Cevap mevcut değil." } catch (e) { throw console.error("Cohere isteğinde hata oluştu:", e.response?.data || e.message), Error(`İstek işlenirken bir hata oluştu: ${e.message}`) } } async analyzeText(e) {
                    let t = `
            You have a flight reservation with the following details:
            - Flight Number: ${e.flightNumber}
            - From: ${e.fromWhereLocation}
            - To: ${e.toWhereLocation}
            - Airline: ${e.flightCompaniName}
            - Reservation Date: ${e.reservationDate}

            Please provide insights in Turkish on:
            1. Best times to book similar flights.
            2. Recommendations for avoiding delays.
            3. Suggested ways to improve the travel experience.
            4. Summarize the text and give me only the answers in the form “1. 2. 3.”.
        `; return await this.sendCohereRequest(t)
                } async analyzeComments(e) {
                    let t = { oneStar: [], twoStars: [], threeStars: [], fourStars: [], fiveStars: [] }; return await Promise.all(e.map(async e => {
                        let r = `
                    Analyze the sentiment of this review in Turkish: 
                    "${e.text}"
                    
                    The review has a star rating of ${e.rating} out of 5. 
                    Please consider this rating while analyzing the sentiment.
                `, o = await this.sendCohereRequest(r), s = e.rating; 1 === s ? t.oneStar.push({ text: e.text, sentiment: o, rating: s }) : 2 === s ? t.twoStars.push({ text: e.text, sentiment: o, rating: s }) : 3 === s ? t.threeStars.push({ text: e.text, sentiment: o, rating: s }) : 4 === s ? t.fourStars.push({ text: e.text, sentiment: o, rating: s }) : 5 === s && t.fiveStars.push({ text: e.text, sentiment: o, rating: s })
                    })), t
                } async analyzeFlightData(e, t) {
                    let r = `
            Based on the flight route from "${e}" to "${t}", list some tips for travelers on this route.
            Provide the response in a numbered list in Turkish.
        `; return (await this.sendCohereRequest(r)).split("\n").filter(e => "" !== e.trim())
                }
            }; t.AIDefaultStrategy = n, t.AIDefaultStrategy = o([(0, a.Injectable)(), s("design:paramtypes", [])], n)
        }, 144: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.CreateReservationDto = void 0; let a = r(403); class i { seatsBooked; reservationDate; status = "pending"; customers; comments } t.CreateReservationDto = i, o([(0, a.IsInt)(), (0, a.Min)(1), (0, a.Max)(10), s("design:type", Number)], i.prototype, "seatsBooked", void 0), o([(0, a.IsDate)(), s("design:type", Date)], i.prototype, "reservationDate", void 0), o([(0, a.IsEnum)(["pending", "confirmed", "canceled"]), s("design:type", String)], i.prototype, "status", void 0), o([(0, a.IsArray)(), s("design:type", Object)], i.prototype, "customers", void 0), o([(0, a.IsArray)(), s("design:type", Object)], i.prototype, "comments", void 0) }, 30: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.CreateReservationUseCase = void 0; let a = r(563), i = r(379), n = r(905), c = class { reservationRepository; userRepository; constructor(e, t) { this.reservationRepository = e, this.userRepository = t } async createReservation(e) { return await this.reservationRepository.create(e) } async findAllReservations() { return await this.reservationRepository.findAll() } async findReservationsByUserId(e) { return await this.reservationRepository.findByUserId(e) } async findAllWithUsers() { let e = await this.reservationRepository.findAll(); return await Promise.all(e.map(async e => { let t, r; return e.customers.forEach(e => { e.name && (t += `${e.name} ,`), e.email && (r += `${e.email} ,`) }), { ...e, customerNames: t, customerEmails: r } })) } async findByUserIdWithReservations(e) { return { user: await this.userRepository.findById(e), reservations: await this.reservationRepository.findByUserId(e) } } }; t.CreateReservationUseCase = c, t.CreateReservationUseCase = o([(0, a.Injectable)(), s("design:paramtypes", [i.ReservationRepository, n.UserRepository])], c) }, 101: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.CreateUserUseCase = void 0; let a = r(905), i = r(563), n = class { userRepository; constructor(e) { this.userRepository = e } async execute(e) { if (!e.email || !e.password) throw new i.BadRequestException("Email and password are required."); if (await this.userRepository.findByEmail(e.email)) throw new i.BadRequestException("User with this email already exists."); return await this.userRepository.create(e) } async findAll() { try { return await this.userRepository.findAll() } catch (e) { throw new i.BadRequestException("Error fetching users") } } async findAllStaff() { try { return await this.userRepository.findAllStaff() } catch (e) { throw new i.BadRequestException("Error fetching users") } } async signIn(e, t) { try { let r = await this.userRepository.findByEmail(e); if (!r || r.password !== t) throw new i.BadRequestException("Invalid credentials."); return r } catch (e) { throw new i.BadRequestException("Error signing in") } } }; t.CreateUserUseCase = n, t.CreateUserUseCase = o([(0, i.Injectable)(), s("design:paramtypes", [a.UserRepository])], n) }, 387: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.SignInUseCase = void 0; let a = r(563), i = r(905), n = r(698), c = class { userRepository; jwtService; constructor(e, t) { this.userRepository = e, this.jwtService = t } async execute(e, t) { let r = await this.userRepository.findByEmail(e); if (await this.userRepository.update(r?.id, { isLoggedOut: !1, updatedAt: new Date().toISOString() }), !r || r.password !== t) throw new a.UnauthorizedException("Invalid credentials"); let o = { username: r.email, sub: r.id }; return { access_token: await this.jwtService.signAsync(o), user: r } } }; t.SignInUseCase = c, t.SignInUseCase = o([(0, a.Injectable)(), s("design:paramtypes", [i.UserRepository, n.JwtServiceWrapper])], c) }, 658: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.SignOutUseCase = void 0; let a = r(563), i = r(698), n = r(905), c = class { jwtServiceWrapper; userRepository; constructor(e, t) { this.jwtServiceWrapper = e, this.userRepository = t } async execute(e) { if (!e) throw new a.UnauthorizedException("No token provided"); let t = i.JwtServiceWrapper.decodeStatic(e, this.jwtServiceWrapper.jwtService); if (!t) throw new a.UnauthorizedException("Invalid token"); let r = t.username, o = await this.userRepository.findByEmail(r); if (!o) throw new a.UnauthorizedException("User not found"); return await this.userRepository.update(o.id, { isLoggedOut: !0, updatedAt: new Date().toISOString() }), { message: "Logged out successfully" } } }; t.SignOutUseCase = c, t.SignOutUseCase = o([(0, a.Injectable)(), s("design:paramtypes", [i.JwtServiceWrapper, n.UserRepository])], c) }, 651: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.CreateReservationUseCase = t.CreateUserUseCase = void 0; var o = r(101); Object.defineProperty(t, "CreateUserUseCase", { enumerable: !0, get: function () { return o.CreateUserUseCase } }); var s = r(30); Object.defineProperty(t, "CreateReservationUseCase", { enumerable: !0, get: function () { return s.CreateReservationUseCase } }) }, 747: (e, t) => { var r, o; Object.defineProperty(t, "__esModule", { value: !0 }), t.User = t.ERoles = t.EMaritalStatus = void 0, function (e) { e[e.Married = 1] = "Married", e[e.Single = 2] = "Single" }(r || (t.EMaritalStatus = r = {})), function (e) { e.Admin = "admin", e.Manager = "manager", e.Field = "staff", e.Employee = "employee", e.Supervisor = "supervisor" }(o || (t.ERoles = o = {})), t.User = class { id; name; phoneNumber; registrationNumber; dateOfBirth; email; password; lastLogin; lastNotificationSeen; ERoles; EUserType; createdAt; updatedAt } }, 873: function (e, t, r) { var o, s = this && this.__createBinding || (Object.create ? function (e, t, r, o) { void 0 === o && (o = r); var s = Object.getOwnPropertyDescriptor(t, r); (!s || ("get" in s ? !t.__esModule : s.writable || s.configurable)) && (s = { enumerable: !0, get: function () { return t[r] } }), Object.defineProperty(e, o, s) } : function (e, t, r, o) { void 0 === o && (o = r), e[o] = t[r] }), a = this && this.__setModuleDefault || (Object.create ? function (e, t) { Object.defineProperty(e, "default", { enumerable: !0, value: t }) } : function (e, t) { e.default = t }), i = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, n = this && this.__importStar || (o = function (e) { return (o = Object.getOwnPropertyNames || function (e) { var t = []; for (var r in e) Object.prototype.hasOwnProperty.call(e, r) && (t[t.length] = r); return t })(e) }, function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var r = o(e), i = 0; i < r.length; i++)"default" !== r[i] && s(t, e, r[i]); return a(t, e), t }); Object.defineProperty(t, "__esModule", { value: !0 }), t.FirebaseModule = void 0; let c = r(563), l = r(428), d = n(r(675)), u = r(554), f = { provide: "FIREBASE_APP", inject: [l.ConfigService], useFactory: e => { let t = { type: "service_account", project_id: "test-a3d1c", private_key_id: "137566bbb26cd2126da6c25c2dc744abfecea84b", private_key: "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC0NpOPkRAWAWfI\nsyS/j4hgBIb/zASDi8wLxoWXd3kpLffXgJoBvdDVtXIoFAjSduKQogc1Om9qnplq\nc2SJFtn2xAq1rrJhHfHIrSeVD+IZJ9+NTbc4k2i0zotZhuYjYHHOfNQTgQCg8D7K\n6k8eNe1QGrlQQMpEhp4x8+gP3Reuuq1rHDQDE3S9hJ5OAtiN3RVBhIwN/u3s4NJd\nQz3CYXbsMcKtQMMiOqx0rCLp732cm1jB+F89O3kwtQJpfXIFy1IQC7grG3F5EZCA\n3RbgIzBXONYoe97ACpiZHGq5WJGHtbuC3oI4l1P2BDktVdo41cfGSOVz2ZcVvGZE\nuHHwhGJHAgMBAAECggEAJhPoDuw4SWYHn1UW3TD/QEaEndTmWUM3HH/YZ14zqBtR\n5GOEZvzL/PPnSIefK5U6HxRVUI5lz1HumZsDMaI18NmQZ74fa7zPgzbvB6SBAg62\nQh2bKqWe+KExuXty8iOlOFuQ1gQqdVb99ZMXn4sGdygGYuolst/82hIuxPdS0zS7\n4dr1LjPGzdAG4l5aN9jepooDe+DUJxStOIeUGXBAXKEIPT4s+5CjqaV4/DZyW1wq\nVICdeivQKXoBd6G+tzVrxUekvMzdUsCVZrHM21GvOqr/vnBF2xN72KuIqEpU+imx\nDvNb6v/64vyMS02d2KXJFKsshytU0gWpU+MBFTrRfQKBgQD2dz4xNU1Db2IsSMQ0\nTAR/zJ+NvWlMQ9RkGjMPatCP2x8226SJDSwBxtU3eR4lXlNXyw1eRl/UlLrq4VVj\nLbGaD9ihRgIq9sv1K7GI2c4NBe/nBPgwCqjb0IZnAIFr6VxWAyYofmA/TwPUHyr+\nPnMD9VuZmhncRTcBXnh72LMF9QKBgQC7Lzt0CySUDWe2f6SysSL+kRDYKNAfwzFF\nGL2f4VWnuQ6vTxVu7rG/EwRSUWQVryBFgJelVkO1vdB/O49+/zd0o6xa7a8hJ07R\n2vBiylwUN177S46fEjx1q4uEXiI6Md0kAXkp/xAfCJGBBRLLquXq190311klIvIz\n46VyXkFlywKBgH9QraHBxP22xeHWXPQe6JwT2b/gPkqVJ1vmZMXsCXymVoOCBoZ9\ndWQdj/qt6DKpfSf2zhsLA2nOwpeeevtWmU3aLa9xeKE1B7rILVdiG5yCmqCd4o7+\nkqeqGiOPEUvrKjWMPuPgFFvftzyWNSFMpSFAV2cLQZyVbIqagGaJVEEZAoGBAKbM\n0A34YAAOcf0OgZU6hBSU8I2u0Md9CMqp4VA3XDy5i3xs3Iyd54Z9S7yPCsDH7doB\nXSDYXj31h3XZfWWNx70InO3qH8VLYdFfaBagfK0HKnyEN/NILNgupYSu3ZE+HfGX\n3oCt6Y+98uslujoDcB51fYvlOmr9WRckJKplk6FBAoGBALnbhyllgEMN9cVzXsU6\n5hS74LUKiMCzHfdd4A4V8NG7eO92jd80dSlyNKAIo89iVZ5KVx0+/ifglWtPkJ6F\nr7TxjVijzQZgNzSRIo+Q5ffb7/PK0+dm7/H6wc8BPetyFpYPS+XhdoUFrtVka4HH\nIZjueGkCslEXoXF3UHHgmTPe\n-----END PRIVATE KEY-----\n", client_email: "firebase-adminsdk-fbsvc@test-a3d1c.iam.gserviceaccount.com", client_id: "115431003891765647736", auth_uri: "https://accounts.google.com/o/oauth2/auth", token_uri: "https://oauth2.googleapis.com/token", auth_provider_x509_cert_url: "https://www.googleapis.com/oauth2/v1/certs", client_x509_cert_url: "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40test-a3d1c.iam.gserviceaccount.com", universe_domain: "googleapis.com" }; return d.initializeApp({ credential: d.credential.cert(t), databaseURL: `https://${t.projectId}.firebaseio.com`, storageBucket: `${t.projectId}.appspot.com` }) } }, p = class { }; t.FirebaseModule = p, t.FirebaseModule = i([(0, c.Module)({ imports: [l.ConfigModule], providers: [f, u.FirebaseRepository], exports: [u.FirebaseRepository] })], p) }, 554: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }, a = this && this.__param || function (e, t) { return function (r, o) { t(r, o, e) } }; Object.defineProperty(t, "__esModule", { value: !0 }), t.FirebaseRepository = void 0; let i = r(563); r(675); let n = class { firebaseApp; #e; constructor(e) { this.firebaseApp = e, this.#e = e.firestore() } async getCollection(e) { return this.#e.collection(e) } async addDocument(e, t) { let r = this.#e.collection(e).doc(); return await r.set(t), r.id } async getDocument(e, t) { let r = this.#e.collection(e).doc(t), o = await r.get(); if (!o.exists) throw Error("Document not found"); return o.data() } async updateDocument(e, t, r) { let o = this.#e.collection(e).doc(t); await o.update(r) } async deleteDocument(e, t) { let r = this.#e.collection(e).doc(t); await r.delete() } }; t.FirebaseRepository = n, t.FirebaseRepository = o([(0, i.Injectable)(), a(0, (0, i.Inject)("FIREBASE_APP")), s("design:paramtypes", [Object])], n) }, 932: function (e, t, r) { var o, s = this && this.__createBinding || (Object.create ? function (e, t, r, o) { void 0 === o && (o = r); var s = Object.getOwnPropertyDescriptor(t, r); (!s || ("get" in s ? !t.__esModule : s.writable || s.configurable)) && (s = { enumerable: !0, get: function () { return t[r] } }), Object.defineProperty(e, o, s) } : function (e, t, r, o) { void 0 === o && (o = r), e[o] = t[r] }), a = this && this.__setModuleDefault || (Object.create ? function (e, t) { Object.defineProperty(e, "default", { enumerable: !0, value: t }) } : function (e, t) { e.default = t }), i = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, n = this && this.__importStar || (o = function (e) { return (o = Object.getOwnPropertyNames || function (e) { var t = []; for (var r in e) Object.prototype.hasOwnProperty.call(e, r) && (t[t.length] = r); return t })(e) }, function (e) { if (e && e.__esModule) return e; var t = {}; if (null != e) for (var r = o(e), i = 0; i < r.length; i++)"default" !== r[i] && s(t, e, r[i]); return a(t, e), t }), c = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.SeedDataService = void 0; let l = r(563), d = r(905), u = r(379), f = r(941), p = r(747), y = n(r(675)), g = class { userRepository; reservationRepository; constructor(e, t) { this.userRepository = e, this.reservationRepository = t } async onModuleInit() { await this.seedUsers(), await this.seedReservations() } async seedUsers() { if ((await this.userRepository.findAll()).length > 10) { console.log("Users collection already contains data. Skipping seeding."); return } console.log("Users collection seeded start."); let e = Object.values(p.ERoles), t = [{ email: "admin@example.com", password: "admin123", name: "Admin User", ERoles: [p.ERoles.Admin, p.ERoles.Manager, p.ERoles.Field, p.ERoles.Employee, p.ERoles.Supervisor], EUserType: p.ERoles.Admin, createdAt: new Date().toISOString() }, ...Array.from({ length: 9 }, () => { let t = [p.ERoles.Field], r = f.faker.number.int({ min: 1, max: 3 }); for (let o = 0; o < r; o++) { let r = f.faker.helpers.arrayElement(e); t.includes(r) || r != p.ERoles.Admin || t.push(r) } return { email: f.faker.internet.email(), password: "password123", name: f.faker.person.fullName(), ERoles: t, EUserType: p.ERoles.Field, createdAt: new Date().toISOString() } })], r = y.firestore().batch(); for (let e of t) { let t = y.firestore().collection("users").doc(); r.set(t, e) } await r.commit(), console.log("Users collection seeded successfully.") } async seedReservations() { let e = await this.reservationRepository.findAll(); if (e.length > 1e3) { console.log("Reservations collection already contains data. Skipping seeding."); return } console.log("Reservations collection seeded start."); let t = Array.from({ length: 1e3 - e.length }, () => { let e; let t = f.faker.number.int({ min: 1, max: 3 }), r = Array.from({ length: t }, () => ({ id: f.faker.string.uuid(), name: f.faker.person.fullName(), email: f.faker.internet.email(), createdAt: new Date().toISOString() })), o = `FL-${f.faker.number.int({ min: 1e3, max: 9999 })}`, s = Array.from({ length: t }).map(() => ({ id: f.faker.string.uuid(), text: f.faker.lorem.sentence(), createdAt: f.faker.date.recent(), rating: f.faker.number.int({ min: 0, max: 5 }), userId: f.faker.string.uuid(), flightId: o })), a = f.faker.location.city(); do e = f.faker.location.city(); while (e === a) let i = f.faker.company.name(), n = ["confirmed", "pending", "cancelled"], c = n[f.faker.number.int({ min: 0, max: n.length - 1 })]; return { id: f.faker.string.uuid(), userId: f.faker.string.uuid(), flightId: o, fromWhereLocation: a, toWhereLocation: e, flightCompaniName: i, flightNumber: `FL-${f.faker.number.int({ min: 1e3, max: 9999 })}`, date: new Date(Date.now() - 864e5 * f.faker.number.int({ min: 0, max: 365 })).toISOString(), reservationDate: new Date().toISOString(), customers: r, comments: s, seatsBooked: r.length, status: c, createdAt: new Date().toISOString() } }), r = y.firestore().batch(); t.forEach(e => { let t = y.firestore().collection("reservations").doc(); r.set(t, e) }), await r.commit(), console.log("Reservations collection seeded successfully.") } }; t.SeedDataService = g, t.SeedDataService = i([(0, l.Injectable)(), c("design:paramtypes", [d.UserRepository, u.ReservationRepository])], g) }, 880: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AuthGuard = void 0; let a = r(563), i = r(781), n = r(142), c = r(698), l = r(905), d = class { jwtService; reflector; userRepository; constructor(e, t, r) { this.jwtService = e, this.reflector = t, this.userRepository = r } async canActivate(e) { if (this.reflector.getAllAndOverride(n.IS_PUBLIC_KEY, [e.getHandler(), e.getClass()])) return !0; let t = e.switchToHttp().getRequest(), r = this.extractTokenFromHeader(t); if (!r) throw new a.UnauthorizedException("No token provided"); try { let e = await this.jwtService.verifyAsync(r); t.user = e; let o = await this.userRepository.findByEmail(e.username); if (!o || o.isLoggedOut) throw new a.UnauthorizedException("User has logged out") } catch { throw new a.UnauthorizedException("Invalid token") } return !0 } extractTokenFromHeader(e) { let t = e.headers.authorization; if (!t) return; let [r, o] = t.split(" "); return "Bearer" === r ? o : void 0 } }; t.AuthGuard = d, t.AuthGuard = o([(0, a.Injectable)(), s("design:paramtypes", [c.JwtServiceWrapper, i.Reflector, l.UserRepository])], d) }, 638: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.CreateUserHook = void 0; let s = r(563), a = class { async beforeCreate(e) { if (!e.email) throw Error("البريد الإلكتروني مطلوب"); if (await this.checkIfUserExists(e.email)) throw Error("المستخدم موجود بالفعل"); console.log("تحققنا من البيانات بنجاح قبل إنشاء المستخدم") } async checkIfUserExists(e) { return !1 } async afterCreate(e) { console.log(`تم إنشاء المستخدم بنجاح: ${e.email}`), await this.sendWelcomeEmail(e) } async sendWelcomeEmail(e) { console.log(`إرسال بريد الترحيب إلى: ${e.email}`) } async onError(e) { console.error(`حدث خطأ أثناء إنشاء المستخدم: ${e.message}`) } }; t.CreateUserHook = a, t.CreateUserHook = o([(0, s.Injectable)()], a) }, 459: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AISuggestionsModule = void 0; let s = r(563), a = r(873), i = r(94), n = r(453), c = r(756), l = class { }; t.AISuggestionsModule = l, t.AISuggestionsModule = o([(0, s.Module)({ imports: [a.FirebaseModule], controllers: [], providers: [i.AIService, n.AIDefaultStrategy, c.AIAdvancedStrategy], exports: [i.AIService] })], l) }, 614: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AuthModule = void 0; let s = r(563), a = r(815), i = r(791), n = r(880), c = r(781), l = r(387), d = r(907), u = r(698), f = r(442), p = r(658), y = class { }; t.AuthModule = y, t.AuthModule = o([(0, s.Module)({ imports: [f.UsersModule, a.JwtModule.register({ global: !0, secret: d.jwtConstants.secret, signOptions: { expiresIn: "10d" } })], controllers: [i.AuthController], providers: [u.JwtServiceWrapper, l.SignInUseCase, p.SignOutUseCase, { provide: c.APP_GUARD, useClass: n.AuthGuard }], exports: [u.JwtServiceWrapper, l.SignInUseCase, p.SignOutUseCase] })], y) }, 345: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.ReservationsModule = void 0; let s = r(563), a = r(873), i = r(55), n = r(30), c = r(379), l = r(94), d = r(905), u = class { }; t.ReservationsModule = u, t.ReservationsModule = o([(0, s.Module)({ imports: [a.FirebaseModule], controllers: [i.ReservationController], providers: [d.UserRepository, c.ReservationRepository, n.CreateReservationUseCase, l.AIService], exports: [d.UserRepository, c.ReservationRepository, n.CreateReservationUseCase] })], u) }, 442: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.UsersModule = void 0; let s = r(563), a = r(933), i = r(905), n = r(651), c = r(638), l = r(873), d = class { }; t.UsersModule = d, t.UsersModule = o([(0, s.Module)({ imports: [l.FirebaseModule], controllers: [a.UserController], providers: [i.UserRepository, n.CreateUserUseCase, c.CreateUserHook], exports: [i.UserRepository, n.CreateUserUseCase, c.CreateUserHook] })], d) }, 458: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.UsersModule = t.ReservationsModule = t.AuthModule = t.AISuggestionsModule = void 0; var o = r(459); Object.defineProperty(t, "AISuggestionsModule", { enumerable: !0, get: function () { return o.AISuggestionsModule } }); var s = r(614); Object.defineProperty(t, "AuthModule", { enumerable: !0, get: function () { return s.AuthModule } }); var a = r(345); Object.defineProperty(t, "ReservationsModule", { enumerable: !0, get: function () { return a.ReservationsModule } }); var i = r(442); Object.defineProperty(t, "UsersModule", { enumerable: !0, get: function () { return i.UsersModule } }) }, 379: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.ReservationRepository = void 0; let a = r(563), i = r(554), n = class { firebaseRepository; collection; constructor(e) { this.firebaseRepository = e, this.collection = this.firebaseRepository.getCollection("reservations") } async findAllPaginated(e, t) { return { data: (await (await this.collection).orderBy("date", "desc").offset((e - 1) * t).limit(t).get()).docs.map(e => ({ id: e.id, ...e.data() })), total: (await (await this.collection).get()).size } } async searchByDateRange(e, t, r, o) { let s = e.toISOString(), a = t.toISOString(); return { data: (await (await this.collection).where("date", ">=", s).where("date", "<=", a).orderBy("date", "desc").offset((r - 1) * o).limit(o).get()).docs.map(e => ({ id: e.id, ...e.data() })), total: (await (await this.collection).where("date", ">=", s).where("date", "<=", a).get()).size } } async create(e) { let t = await (await this.collection).add(e), r = await t.get(); return { id: r.id, ...r.data() } } async findByUserId(e) { return (await (await this.collection).where("userId", "==", e).get()).docs.map(e => ({ id: e.id, ...e.data() })) } async findAll() { return (await (await this.collection).get()).docs.map(e => ({ id: e.id, ...e.data() })) } async deleteById(e) { await (await this.collection).doc(e).delete() } async getReservationById(e) { try { let t = await (await this.collection).where("id", "==", e).get(); if (t.empty) return console.error(`Reservation not found for ID: ${e}`), null; let r = t.docs[0]; return { id: r.id, ...r.data() } } catch (t) { throw console.error(`Error retrieving reservation with ID: ${e}`, t), Error("Error retrieving reservation") } } }; t.ReservationRepository = n, t.ReservationRepository = o([(0, a.Injectable)(), s("design:paramtypes", [i.FirebaseRepository])], n) }, 346: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.UserRepository = void 0; let a = r(563), i = r(554), n = class { firebaseRepository; collection; constructor(e) { this.firebaseRepository = e, this.collection = this.firebaseRepository.getCollection("users") } async create(e) { try { let t = await (await this.collection).add(e), r = await t.get(); return { id: r.id, ...r.data() } } catch (e) { throw console.error("Error creating user:", e), e } } async findByEmail(e) { try { let t = await (await this.collection).where("email", "==", e).get(); if (t.empty) return null; let r = t.docs[0]; return { id: r.id, ...r.data() } } catch (e) { throw console.error("Error finding user by email:", e), e } } async findById(e) { let t = await (await this.collection).doc(e).get(); if (!t.exists) throw Error("User not found"); return { id: t.id, ...t.data() } } async findAll() { return (await (await this.collection).get()).docs.map(e => ({ id: e.id, ...e.data() })) } async findAllStaff() { return (await (await this.collection).where("EUserType", "==", "staff").get()).docs.map(e => ({ id: e.id, ...e.data() })).map(e => ({ ...e, allERoles: e.ERoles.join(", ") })) } async deleteById(e) { await (await this.collection).doc(e).delete() } async update(e, t) { try { let r = (await this.collection).doc(e); if (!(await r.get()).exists) throw Error("User not found"); await r.update(t); let o = await r.get(); return { id: o.id, ...o.data() } } catch (e) { throw console.error("Error updating user:", e), e } } }; t.UserRepository = n, t.UserRepository = o([(0, a.Injectable)(), s("design:paramtypes", [i.FirebaseRepository])], n) }, 905: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.UserRepository = void 0; var o = r(346); Object.defineProperty(t, "UserRepository", { enumerable: !0, get: function () { return o.UserRepository } }) }, 698: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.JwtServiceWrapper = void 0; let a = r(563), i = r(815), n = class { jwtService; constructor(e) { this.jwtService = e } signAsync(e, t) { return this.jwtService.signAsync(e, t) } verifyAsync(e, t) { return this.jwtService.verifyAsync(e, t) } decode(e) { return this.jwtService.decode(e) } static decodeStatic(e, t) { return t.decode(e) } }; t.JwtServiceWrapper = n, t.JwtServiceWrapper = o([(0, a.Injectable)(), s("design:paramtypes", [i.JwtService])], n) }, 94: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AIService = void 0; let a = r(563), i = r(453), n = class { aiStrategy; constructor() { this.aiStrategy = new i.AIDefaultStrategy } setStrategy(e) { this.aiStrategy = e } async generateSuggestion(e) { return await this.aiStrategy.generateSuggestion(e) } }; t.AIService = n, t.AIService = o([(0, a.Injectable)(), s("design:paramtypes", [])], n) }, 998: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }; Object.defineProperty(t, "__esModule", { value: !0 }), t.injectDBModules = void 0; let s = r(563), a = r(932), i = r(458), n = class { }; t.injectDBModules = n, t.injectDBModules = o([(0, s.Module)({ imports: [i.AuthModule, i.ReservationsModule, i.AISuggestionsModule, i.UsersModule], providers: [a.SeedDataService] })], n) }, 791: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }, a = this && this.__param || function (e, t) { return function (r, o) { t(r, o, e) } }; Object.defineProperty(t, "__esModule", { value: !0 }), t.AuthController = void 0; let i = r(563), n = r(387), c = r(142), l = r(658), d = class { signInUseCase; signOutUseCase; constructor(e, t) { this.signInUseCase = e, this.signOutUseCase = t } async signIn(e) { return this.signInUseCase.execute(e.email, e.password) } async logOut(e) { let t = e.headers.authorization?.split(" ")[1]; return this.signOutUseCase.execute(t) } getProfile(e) { return e.user } }; t.AuthController = d, o([(0, c.Public)(), (0, i.HttpCode)(i.HttpStatus.OK), (0, i.Post)("login"), a(0, (0, i.Body)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", Promise)], d.prototype, "signIn", null), o([(0, i.Post)("logout"), (0, i.HttpCode)(i.HttpStatus.OK), a(0, (0, i.Request)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", Promise)], d.prototype, "logOut", null), o([(0, i.Get)("profile"), a(0, (0, i.Request)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", void 0)], d.prototype, "getProfile", null), t.AuthController = o([(0, i.Controller)("auth"), s("design:paramtypes", [n.SignInUseCase, l.SignOutUseCase])], d) }, 55: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }, a = this && this.__param || function (e, t) { return function (r, o) { t(r, o, e) } }; Object.defineProperty(t, "__esModule", { value: !0 }), t.ReservationController = void 0; let i = r(563), n = r(144), c = r(30), l = r(379), d = r(142), u = r(94), f = class { createReservationUseCase; reservationRepository; aiService; constructor(e, t, r) { this.createReservationUseCase = e, this.reservationRepository = t, this.aiService = r } async getAggregatedReservations(e = "1", t = "10", r) { try { let o = parseInt(e, 10), s = parseInt(t, 10), a = await this.aggregateReservations(o, s); r.status(i.HttpStatus.OK).send(a) } catch (e) { e instanceof Error ? r.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e.message }) : r.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e }) } } async aggregateReservations(e, t) { let { data: r, total: o } = await this.reservationRepository.findAllPaginated(e, t); return { data: await Promise.all(r.map(async e => { let t = "", r = "", o = ""; return e.customers.forEach(e => { e.name && (t += `${e.name}, `), e.email && (o += `${e.email}, `) }), e.comments.forEach(e => { e.text && (r += `${e.text}, `) }), { ...e, customerNames: t.trimEnd().replace(/,$/, ""), customerEmails: o.trimEnd().replace(/,$/, ""), commentsText: r.trimEnd().replace(/,$/, "") } })), total: o } } async searchReservationsByDate(e, t, r, o = "1", s = "10") { try { let a; let n = parseInt(o, 10), c = parseInt(s, 10); a = t && r ? await this.reservationRepository.searchByDateRange(new Date(t), new Date(r), n, c) : await this.reservationRepository.findAllPaginated(n, c), e.status(i.HttpStatus.OK).send(a) } catch (t) { t instanceof Error ? e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t.message }) : e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } async findAllWithUsers(e) { try { let t = await this.createReservationUseCase.findAllWithUsers(); e.status(i.HttpStatus.OK).send(t) } catch (t) { t instanceof Error ? e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t.message }) : e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } async findByUserIdWithReservations(e, t) { try { let r = await this.createReservationUseCase.findByUserIdWithReservations(e); t.status(i.HttpStatus.OK).send(r) } catch (e) { e instanceof Error ? t.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e.message }) : t.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e }) } } async create(e, t) { try { let r = await this.createReservationUseCase.createReservation(t); e.status(i.HttpStatus.CREATED).send(r) } catch (t) { t instanceof Error ? e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t.message }) : e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } async findAll(e) { try { let t = await this.reservationRepository.findAll(); e.status(i.HttpStatus.OK).send(t) } catch (t) { t instanceof Error ? e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t.message }) : e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } async findById(e, t) { try { let r = await this.reservationRepository.getReservationById(e); t.status(i.HttpStatus.OK).send(r) } catch (e) { e instanceof Error ? t.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e.message }) : t.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e }) } } async findByUserId(e, t) { try { let r = await this.reservationRepository.findByUserId(e); t.status(i.HttpStatus.OK).send(r) } catch (e) { e instanceof Error ? t.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e.message }) : t.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: e }) } } async getReservationSuggestionai(e, t) { if (!e) throw Error("Invalid reservation data."); let r = await this.reservationRepository.getReservationById(e); if (!r) throw Error("Reservation not found."); let o = r.comments?.map(e => ({ id: e.id, text: e.text, createdAt: e.createdAt, userId: e.userId, flightId: e.flightId })) || [], s = await this.aiService.generateSuggestion({ ...r, comments: o }); t.status(i.HttpStatus.OK).send(s) } async getReservationSuggestion(e) { return await this.aiService.generateSuggestion({ date: "2025-01-26", clientCount: 2 }) } }; t.ReservationController = f, o([(0, i.Get)(), a(0, (0, i.Query)("page")), a(1, (0, i.Query)("limit")), a(2, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [String, String, Object]), s("design:returntype", Promise)], f.prototype, "getAggregatedReservations", null), o([(0, i.Get)("search"), a(0, (0, i.Res)()), a(1, (0, i.Query)("startDate")), a(2, (0, i.Query)("endDate")), a(3, (0, i.Query)("page")), a(4, (0, i.Query)("limit")), s("design:type", Function), s("design:paramtypes", [Object, String, String, String, String]), s("design:returntype", Promise)], f.prototype, "searchReservationsByDate", null), o([(0, i.Get)("aggregated"), a(0, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", Promise)], f.prototype, "findAllWithUsers", null), o([(0, i.Get)("user/:userId/aggregated"), a(0, (0, i.Param)("userId")), a(1, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [String, Object]), s("design:returntype", Promise)], f.prototype, "findByUserIdWithReservations", null), o([(0, i.Post)("add"), a(0, (0, i.Res)()), a(1, (0, i.Body)()), s("design:type", Function), s("design:paramtypes", [Object, n.CreateReservationDto]), s("design:returntype", Promise)], f.prototype, "create", null), o([(0, i.Get)("all"), a(0, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", Promise)], f.prototype, "findAll", null), o([(0, i.Get)(":id"), a(0, (0, i.Param)("id")), a(1, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [String, Object]), s("design:returntype", Promise)], f.prototype, "findById", null), o([(0, i.Get)("user/:userId"), a(0, (0, i.Param)("userId")), a(1, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [String, Object]), s("design:returntype", Promise)], f.prototype, "findByUserId", null), o([(0, d.Public)(), (0, i.Post)("suggestion/:reservationId"), a(0, (0, i.Param)("reservationId")), a(1, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [String, Object]), s("design:returntype", Promise)], f.prototype, "getReservationSuggestionai", null), o([(0, i.Get)(":id/suggestion"), a(0, (0, i.Param)("id")), s("design:type", Function), s("design:paramtypes", [String]), s("design:returntype", Promise)], f.prototype, "getReservationSuggestion", null), t.ReservationController = o([(0, i.Controller)("reservations"), s("design:paramtypes", [c.CreateReservationUseCase, l.ReservationRepository, u.AIService])], f) }, 446: function (e, t, r) { var o = this && this.__decorate || function (e, t, r, o) { var s, a = arguments.length, i = a < 3 ? t : null === o ? o = Object.getOwnPropertyDescriptor(t, r) : o; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(e, t, r, o); else for (var n = e.length - 1; n >= 0; n--)(s = e[n]) && (i = (a < 3 ? s(i) : a > 3 ? s(t, r, i) : s(t, r)) || i); return a > 3 && i && Object.defineProperty(t, r, i), i }, s = this && this.__metadata || function (e, t) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(e, t) }, a = this && this.__param || function (e, t) { return function (r, o) { t(r, o, e) } }; Object.defineProperty(t, "__esModule", { value: !0 }), t.UserController = void 0; let i = r(563), n = r(101), c = r(142), l = class { createUserUseCase; constructor(e) { this.createUserUseCase = e } async findAll(e) { try { let t = await this.createUserUseCase.findAll(); e.status(i.HttpStatus.OK).send(t) } catch (t) { console.error(t), e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } async findAllStaff(e) { try { let t = await this.createUserUseCase.findAllStaff(); e.status(i.HttpStatus.OK).send(t) } catch (t) { console.error(t), e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } async signIn(e, t) { try { let r = await this.createUserUseCase.signIn(t.email, t.password); if (r) return e.status(i.HttpStatus.OK).send(r), r; e.status(i.HttpStatus.UNAUTHORIZED).send({ error: "Invalid credentials" }) } catch (t) { console.log(t), e.status(i.HttpStatus.BAD_REQUEST).send({ error: t }) } } async create(e, t) { try { let r = await this.createUserUseCase.execute(t); e.status(i.HttpStatus.CREATED).send(r) } catch (t) { console.error(t), e.status(i.HttpStatus.INTERNAL_SERVER_ERROR).send({ error: t }) } } }; t.UserController = l, o([(0, i.Get)("all"), a(0, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", Promise)], l.prototype, "findAll", null), o([(0, i.Get)("allStaff"), a(0, (0, i.Res)()), s("design:type", Function), s("design:paramtypes", [Object]), s("design:returntype", Promise)], l.prototype, "findAllStaff", null), o([(0, i.Post)("signIn"), a(0, (0, i.Res)({ passthrough: !0 })), a(1, (0, i.Body)()), s("design:type", Function), s("design:paramtypes", [Object, Object]), s("design:returntype", Promise)], l.prototype, "signIn", null), o([(0, c.Public)(), (0, i.Post)("add"), a(0, (0, i.Res)()), a(1, (0, i.Body)()), s("design:type", Function), s("design:paramtypes", [Object, Object]), s("design:returntype", Promise)], l.prototype, "create", null), t.UserController = o([(0, i.Controller)("users"), s("design:paramtypes", [n.CreateUserUseCase])], l) }, 933: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.UserController = void 0; var o = r(446); Object.defineProperty(t, "UserController", { enumerable: !0, get: function () { return o.UserController } }) }, 142: (e, t, r) => { Object.defineProperty(t, "__esModule", { value: !0 }), t.Public = t.IS_PUBLIC_KEY = void 0; let o = r(563); t.IS_PUBLIC_KEY = "isPublic", t.Public = () => (0, o.SetMetadata)(t.IS_PUBLIC_KEY, !0) }, 941: e => { e.exports = require("@faker-js/faker") }, 563: e => { e.exports = require("@nestjs/common") }, 428: e => { e.exports = require("@nestjs/config") }, 781: e => { e.exports = require("@nestjs/core") }, 815: e => { e.exports = require("@nestjs/jwt") }, 560: e => { e.exports = require("@nestjs/platform-fastify") }, 403: e => { e.exports = require("class-validator") }, 869: e => { e.exports = require("cohere-ai") }, 818: e => { e.exports = require("dotenv") }, 675: e => { e.exports = require("firebase-admin") }
    }, t = {}; function r(o) { var s = t[o]; if (void 0 !== s) return s.exports; var a = t[o] = { exports: {} }; return e[o].call(a.exports, a, a.exports, r), a.exports } (() => { let e = r(781), t = r(511), o = r(560), s = r(428), a = r(257); !async function () { let r = await e.NestFactory.create(t.AppModule, new o.FastifyAdapter, { cors: { origin: "*" }, httpsOptions: { rejectUnauthorized: !1 } }), { httpAdapter: i } = r.get(e.HttpAdapterHost); r.useGlobalFilters(new a.AllExceptionsFilter(i)); let n = r.get(s.ConfigService).get("PORT"); await r.listen(n || 3e3, "0.0.0.0", () => { console.log(`Application running on: http://localhost:${n || 3e3}`) }) }() })()
})();